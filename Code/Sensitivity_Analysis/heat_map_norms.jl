using Plots
using Plots.PlotMeasures

"""
Plotting heat map of sensitivity vector norms.
"""

sens_vecs_norms_J = [9.26622192984749e-83, 6.199363652118643e-82, 1.0416850049465761e-82, 2.083370009893272e-81, 1.01990679342827e-85, 6.915654509276809e-85, 5.826578392672943, 8.552855602215306, 26.09289256729542, 0.10159998444453983, 4.192729880190434, 33.73310325189666, 1.693018615669053, 5.839950228203912, 2.6803289313627734, 4.243815362499611, 0.39774001277358123, 2.6803289313269807, 4.8077552876259217e-82, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.005241084996545, 9.206197296222529, 1.3047241691323417, 0.07843762857196276, 26.448047074428416, 2.284875958460941, 0.6869541763121036, 0.19041189089266827, 0.030238220341100866, 0.15248757323929057, 0.2116726669155748, 0.22371544760264084, 4.0265396423999e-85, 1.2875020270689658e-81, 0.0, 1.0645695331143257e-82, 1.7815962292374577e-81, 1.2875020270689658e-81, 6.192688808627593e-81, 7.661099945352211e-81, 0.5942238267868692, 4.403353957217699, 0.6436352658237754, 0.0002495495772766368, 2.809733042924583, 2.3668221434263956, 0.3535024891993128, 3.596432663571507, 0.8484041209669984, 3.3955039995455816, 30.58113115499503, 5.491953491885848e-81, 3.61525244043213e-83, 2.0951046745653088e-79, 6.319702745095398e-78, 6.524773200141166e-80, 2.9128913251374055e-82, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
sens_vecs_norms_1 = [3.564967586517337e-59, 2.2947947273843014e-58, 3.848288211564662e-59, 7.696576423134698e-58, 0.0, 1.5903578374549422e-60, 7.763712493544722, 5.221678293533744, 8.10751213797895, 0.08741548802242421, 4.481740916590661, 26.536645943436287, 0.6333904678827861, 5.780004542899831, 1.015329639572965, 1.233533743407828, 0.08246541631782622, 1.015329639576713, 1.7250623971288176e-58, 0.0, 0.0, 0.0, 0.0, 3.752759195610599e-73, 0.0, 0.0, 0.0, 0.0, 0.0, 8.245364356562339e-31, 8.070915875512187, 0.4053718836837988, 0.0, 0.0, 0.0, 0.0, 22.687075424234916, 0.006165422543429877, 0.09915124921068613, 0.12633686837180802, 0.13744982920863044, 7.753102913760106e-61, 4.643223536882969e-58, 4.048602410882423e-73, 4.360526564574033e-59, 7.431084357402258e-58, 4.6432235368846736e-58, 3.993966641419205e-57, 2.7675031649687536e-57, 0.496374468062794, 6.705572362392653, 0.5303882068289906, 0.003092359362399897, 2.741176182777961, 1.6360957401580447, 0.07264382886500893, 0.13346130217730207, 0.25014637416020225, 0.24014902909305677, 0.9019286459357376, 2.772039672393223e-61, 5.159129212616369e-15, 1.5012556193058195e-58, 1.3225607439188606e-56, 5.901412307958942e-59, 1.1179735325118517e-58, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
sens_vecs_norms_2 = [2.321020062607893e-34, 1.5536708662501688e-33, 2.6113755424605766e-34, 5.222751084917219e-33, 0.0, 1.6003880263581362e-35, 8.34438981053693, 6.422214664639807, 12.708591030155102, 0.1295719294226665, 4.480538813768821, 31.942632128581874, 1.5091835606527957, 7.88923234708452, 3.229826973738763, 2.786822121468262, 0.46004065299573793, 3.229826973780243, 8.773346177487682e-34, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2085350373477662e-29, 10.906160461135022, 0.6354894339468481, 0.0, 0.0, 0.0, 0.0, 31.677074512431528, 0.03343935180889186, 0.14510155122224533, 0.1586126740698386, 0.23575003374443015, 2.291805967456645e-36, 2.2795138604616795e-33, 0.0, 2.6081301062991225e-34, 4.10379841726244e-33, 2.2795138604616795e-33, 1.1712930880217713e-32, 1.3559641616467553e-32, 0.6091833957428854, 6.55723798234969, 0.6545620850214433, 0.0010337373490452786, 2.70488247175642, 2.2204124440683217, 0.27080530606602243, 1.5316949313448154, 1.2971955639080461, 4.481631977154386, 20.047072462755725, 5.642471587320884e-33, 1.6521932235247338e-34, 1.6352088340972483e-31, 5.940607271794402e-30, 1.202566480834141e-31, 8.612949364958284e-34, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

abs_senses = hcat(sens_vector_norms_J, sens_vector_norms_1, sens_vector_norms_2)

x_labels = p_var_lookup_table

y_labels = ["Jalihal","Parametervektor 1","Parametervektor 2"]
width = 1000
height = 300


Plots.heatmap(abs_senses',xticks = (1:81,x_labels),yticks = (1:3,y_labels),xrotation=90,size = (width,height),bottom_margin = 75px)